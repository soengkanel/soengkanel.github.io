{% extends 'base/base.html' %}
{% load static %}
{% load i18n %}

{% block title %}{% trans "Exit Checklist" %} - {{ employee.full_name }}{% endblock %}

{% block extra_css %}
<style>
    .page-header {
        padding: 6px 0;
        margin-bottom: 12px;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .page-header h2 {
        font-size: 16px;
        font-weight: 600;
        margin: 0;
        color: #1a1a1a;
    }

    .info-card {
        background: white;
        border: 1px solid #e2e8f0;
        border-radius: 6px;
        padding: 16px;
        margin-bottom: 16px;
    }

    .section-title {
        font-size: 14px;
        font-weight: 600;
        color: #1a1a1a;
        margin-bottom: 12px;
        padding-bottom: 8px;
        border-bottom: 1px solid #e2e8f0;
    }

    .checklist-section {
        margin-bottom: 24px;
    }

    .checklist-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 10px 12px;
        border-bottom: 1px solid #f3f4f6;
        font-size: 13px;
    }

    .checklist-item:last-child {
        border-bottom: none;
    }

    .item-label {
        color: #374151;
    }

    .status-badge {
        font-size: 11px;
        padding: 4px 10px;
        border-radius: 12px;
        font-weight: 500;
    }

    .status-completed {
        background: #d1fae5;
        color: #065f46;
    }

    .status-pending {
        background: #fef3c7;
        color: #92400e;
    }

    .status-not-applicable {
        background: #f3f4f6;
        color: #6b7280;
    }

    .progress-summary {
        background: #eff6ff;
        border: 1px solid #bfdbfe;
        border-radius: 6px;
        padding: 20px;
        text-align: center;
        margin-bottom: 20px;
    }

    .progress-circle {
        width: 100px;
        height: 100px;
        margin: 0 auto 12px;
        border-radius: 50%;
        background: conic-gradient(
            #10b981 0% var(--progress),
            #e5e7eb var(--progress) 100%
        );
        display: flex;
        align-items: center;
        justify-content: center;
        position: relative;
    }

    .progress-circle::before {
        content: '';
        width: 75px;
        height: 75px;
        border-radius: 50%;
        background: white;
        position: absolute;
    }

    .progress-text {
        position: relative;
        z-index: 1;
        font-size: 24px;
        font-weight: 700;
        color: #1a1a1a;
    }

    .category-header {
        background: #f9fafb;
        padding: 10px 12px;
        border-radius: 6px;
        margin-bottom: 8px;
        font-size: 12px;
        font-weight: 600;
        color: #374151;
        text-transform: uppercase;
    }
</style>
{% endblock %}

{% block content %}
<div class="container-fluid">
    <!-- Page Header -->
    <div class="page-header">
        <h2>{% trans "Exit Checklist" %} - {{ employee.full_name }}</h2>
        <div>
            <a href="{% url 'hr:exit_checklist_update' employee.pk %}" class="btn btn-primary btn-sm">
                ‚úèÔ∏è {% trans "Update Checklist" %}
            </a>
            <a href="{% url 'hr:employee_detail' employee.pk %}" class="btn btn-outline-secondary btn-sm">
                {% trans "Back to Employee" %}
            </a>
        </div>
    </div>

    <div class="row">
        <!-- Main Content -->
        <div class="col-lg-8">
            {% if exit_checklist %}
                <!-- Progress Summary -->
                <div class="progress-summary">
                    <div class="progress-circle" style="--progress: {{ exit_checklist.completion_percentage }}%">
                        <span class="progress-text">{{ exit_checklist.completion_percentage|floatformat:0 }}%</span>
                    </div>
                    <div style="font-size: 14px; color: #1f2937; font-weight: 500;">
                        {% trans "Checklist Completion" %}
                    </div>
                    <div style="font-size: 12px; color: #6b7280; margin-top: 4px;">
                        {% trans "Complete all items before final exit" %}
                    </div>
                </div>

                <!-- HR Tasks -->
                <div class="info-card">
                    <div class="category-header">üè¢ {% trans "HR Tasks" %}</div>
                    <div class="checklist-section">
                        <div class="checklist-item">
                            <span class="item-label">{% trans "Final Interview Completed" %}</span>
                            <span class="status-badge status-{{ exit_checklist.final_interview_completed }}">
                                {{ exit_checklist.get_final_interview_completed_display }}
                            </span>
                        </div>
                        <div class="checklist-item">
                            <span class="item-label">{% trans "Benefits Explained" %}</span>
                            <span class="status-badge status-{{ exit_checklist.benefits_explained }}">
                                {{ exit_checklist.get_benefits_explained_display }}
                            </span>
                        </div>
                        <div class="checklist-item">
                            <span class="item-label">{% trans "COBRA Forms Completed" %}</span>
                            <span class="status-badge status-{{ exit_checklist.cobra_forms }}">
                                {{ exit_checklist.get_cobra_forms_display }}
                            </span>
                        </div>
                        <div class="checklist-item">
                            <span class="item-label">{% trans "Final Paycheck Processed" %}</span>
                            <span class="status-badge status-{{ exit_checklist.final_paycheck }}">
                                {{ exit_checklist.get_final_paycheck_display }}
                            </span>
                        </div>
                    </div>
                </div>

                <!-- IT Tasks -->
                <div class="info-card">
                    <div class="category-header">üíª {% trans "IT Tasks" %}</div>
                    <div class="checklist-section">
                        <div class="checklist-item">
                            <span class="item-label">{% trans "Laptop Returned" %}</span>
                            <span class="status-badge status-{{ exit_checklist.laptop_returned }}">
                                {{ exit_checklist.get_laptop_returned_display }}
                            </span>
                        </div>
                        <div class="checklist-item">
                            <span class="item-label">{% trans "Phone Returned" %}</span>
                            <span class="status-badge status-{{ exit_checklist.phone_returned }}">
                                {{ exit_checklist.get_phone_returned_display }}
                            </span>
                        </div>
                        <div class="checklist-item">
                            <span class="item-label">{% trans "ID Card Returned" %}</span>
                            <span class="status-badge status-{{ exit_checklist.id_card_returned }}">
                                {{ exit_checklist.get_id_card_returned_display }}
                            </span>
                        </div>
                        <div class="checklist-item">
                            <span class="item-label">{% trans "Access Revoked" %}</span>
                            <span class="status-badge status-{{ exit_checklist.access_revoked }}">
                                {{ exit_checklist.get_access_revoked_display }}
                            </span>
                        </div>
                        <div class="checklist-item">
                            <span class="item-label">{% trans "Email Deactivated" %}</span>
                            <span class="status-badge status-{{ exit_checklist.email_deactivated }}">
                                {{ exit_checklist.get_email_deactivated_display }}
                            </span>
                        </div>
                    </div>
                </div>

                <!-- Finance Tasks -->
                <div class="info-card">
                    <div class="category-header">üí∞ {% trans "Finance Tasks" %}</div>
                    <div class="checklist-section">
                        <div class="checklist-item">
                            <span class="item-label">{% trans "Expense Reports Settled" %}</span>
                            <span class="status-badge status-{{ exit_checklist.expense_reports }}">
                                {{ exit_checklist.get_expense_reports_display }}
                            </span>
                        </div>
                        <div class="checklist-item">
                            <span class="item-label">{% trans "Company Credit Card Returned" %}</span>
                            <span class="status-badge status-{{ exit_checklist.company_credit_card }}">
                                {{ exit_checklist.get_company_credit_card_display }}
                            </span>
                        </div>
                        <div class="checklist-item">
                            <span class="item-label">{% trans "Outstanding Advances Cleared" %}</span>
                            <span class="status-badge status-{{ exit_checklist.outstanding_advances }}">
                                {{ exit_checklist.get_outstanding_advances_display }}
                            </span>
                        </div>
                    </div>
                </div>

                <!-- Manager Tasks -->
                <div class="info-card">
                    <div class="category-header">üë§ {% trans "Manager Tasks" %}</div>
                    <div class="checklist-section">
                        <div class="checklist-item">
                            <span class="item-label">{% trans "Knowledge Transfer Completed" %}</span>
                            <span class="status-badge status-{{ exit_checklist.knowledge_transfer }}">
                                {{ exit_checklist.get_knowledge_transfer_display }}
                            </span>
                        </div>
                        <div class="checklist-item">
                            <span class="item-label">{% trans "Project Handover Completed" %}</span>
                            <span class="status-badge status-{{ exit_checklist.project_handover }}">
                                {{ exit_checklist.get_project_handover_display }}
                            </span>
                        </div>
                        <div class="checklist-item">
                            <span class="item-label">{% trans "Keys Returned" %}</span>
                            <span class="status-badge status-{{ exit_checklist.keys_returned }}">
                                {{ exit_checklist.get_keys_returned_display }}
                            </span>
                        </div>
                    </div>
                </div>

                <!-- General Tasks -->
                <div class="info-card">
                    <div class="category-header">üì¶ {% trans "General Tasks" %}</div>
                    <div class="checklist-section">
                        <div class="checklist-item">
                            <span class="item-label">{% trans "Locker Cleared" %}</span>
                            <span class="status-badge status-{{ exit_checklist.locker_cleared }}">
                                {{ exit_checklist.get_locker_cleared_display }}
                            </span>
                        </div>
                        <div class="checklist-item">
                            <span class="item-label">{% trans "Uniform Returned" %}</span>
                            <span class="status-badge status-{{ exit_checklist.uniform_returned }}">
                                {{ exit_checklist.get_uniform_returned_display }}
                            </span>
                        </div>
                    </div>
                </div>

                <!-- Notes -->
                {% if exit_checklist.notes %}
                <div class="info-card">
                    <div class="section-title">üìù {% trans "Notes" %}</div>
                    <p style="font-size: 13px; color: #374151;">{{ exit_checklist.notes }}</p>
                </div>
                {% endif %}

                <!-- Final Clearance -->
                {% if exit_checklist.all_cleared_by %}
                <div class="info-card" style="border-left: 3px solid #10b981;">
                    <div class="section-title">‚úÖ {% trans "Final Clearance" %}</div>
                    <p style="font-size: 13px; color: #374151;">
                        {% trans "Cleared by" %} {{ exit_checklist.all_cleared_by.get_full_name }}
                        {% trans "on" %} {{ exit_checklist.all_cleared_date|date:"M d, Y" }}
                    </p>
                </div>
                {% endif %}

            {% else %}
                <!-- No Checklist Created -->
                <div class="info-card text-center" style="padding: 40px 20px;">
                    <div style="font-size: 48px; margin-bottom: 16px;">üìã</div>
                    <h3 style="font-size: 16px; font-weight: 600; color: #1a1a1a; margin-bottom: 8px;">
                        {% trans "No Exit Checklist Created" %}
                    </h3>
                    <p style="font-size: 13px; color: #6b7280; margin-bottom: 20px;">
                        {% trans "Create an exit checklist to track the offboarding process" %}
                    </p>
                    <a href="{% url 'hr:exit_checklist_update' employee.pk %}" class="btn btn-primary">
                        {% trans "Create Exit Checklist" %}
                    </a>
                </div>
            {% endif %}
        </div>

        <!-- Sidebar -->
        <div class="col-lg-4">
            <!-- Employee Info -->
            <div class="info-card">
                <div class="section-title">{% trans "Employee Information" %}</div>
                <div style="font-size: 13px; color: #374151;">
                    <div class="mb-2">
                        <strong>{% trans "Name:" %}</strong> {{ employee.full_name }}
                    </div>
                    <div class="mb-2">
                        <strong>{% trans "ID:" %}</strong> {{ employee.employee_id }}
                    </div>
                    <div class="mb-2">
                        <strong>{% trans "Department:" %}</strong> {{ employee.department.name|default:"-" }}
                    </div>
                    <div>
                        <strong>{% trans "Position:" %}</strong> {{ employee.position.name|default:"-" }}
                    </div>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="info-card">
                <div class="section-title">{% trans "Quick Actions" %}</div>
                <div class="d-grid gap-2">
                    <a href="{% url 'hr:exit_checklist_update' employee.pk %}" class="btn btn-primary btn-sm">
                        ‚úèÔ∏è {% trans "Update Checklist" %}
                    </a>
                    <a href="{% url 'hr:employee_detail' employee.pk %}" class="btn btn-outline-secondary btn-sm">
                        üë§ {% trans "View Employee" %}
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
