<!DOCTYPE html>

{% load static %}
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Invoice - {{ invoice.invoice_number }}</title>
    <link rel="stylesheet" href="{% static 'css/tailwind.min.css' %}">
    <link rel="stylesheet" href="{% static 'css/button-mini.css' %}">
    <link href="{% static 'vendor/fonts/google-fonts.css' %}" rel="stylesheet">
    <style>
         .moul-regular {
            font-family: "Moul", serif;
            font-weight: 400;
            font-style: normal;
        }
        .time-roman{
            font-family: 'Times New Roman', Times, serif;
            font-style: normal;
        }
        .noto-sans-sc-500 {
        font-family: "Noto Sans SC", sans-serif;
        font-optical-sizing: auto;
        font-weight: 500;
        font-style: normal;
        }
        .kh-content-regular {
        font-family: "Content", system-ui;
        font-weight: 400;
        font-style: normal;
        }

        .kh-content-bold {
            font-family: "Content", system-ui;
            font-weight: 500;
            font-style: normal;
        }
        @page {
            size: A4;
            margin: 1cm;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: white;
        }
        
        .invoice-container {
            width: 100%;
            max-width: 21cm;
            margin: 0 auto;
            background: white;
        }
        
        /* Header Section */
        .invoice-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            padding: 20px 0;
            border-bottom: 2px solid #2563eb;
            margin-bottom: 30px;
        }
        
        .company-info {
            flex: 1;
        }
        
        .company-logo {
            margin-bottom: 10px;
        }
        
        .company-logo img {
            max-height: 60px;
            max-width: 200px;
            object-fit: contain;
        }
        
        .company-name {
            font-size: 24px;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 5px;
        }
        
        .company-tagline {
            font-size: 14px;
            color: #6b7280;
            margin-bottom: 10px;
        }
        
        .company-details {
            font-size: 11px;
            color: #6b7280;
            line-height: 1.3;
        }
        
        .invoice-meta {
            text-align: right;
            min-width: 200px;
        }
        
        .invoice-title {
            font-size: 28px;
            font-weight: 700;
            color: #2563eb;
            margin-bottom: 10px;
        }
        
        .invoice-number {
            font-size: 14px;
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 5px;
        }
        
        .invoice-date {
            font-size: 12px;
            color: #6b7280;
        }
        
        /* Body Section */
        .invoice-body {
            margin-bottom: 40px;
        }
        
        /* Client Information */
        .client-section {
            display: flex;
            justify-content: space-between;
            margin-bottom: 30px;
        }
        
        .client-info, .invoice-details {
            width: 48%;
        }
        
        .section-title {
            font-size: 14px;
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 10px;
            padding-bottom: 5px;
            border-bottom: 1px solid #e5e7eb;
        }
        
        .info-row {
            display: flex;
            margin-bottom: 5px;
        }
        
        .info-label {
            font-weight: 500;
            color: #6b7280;
            min-width: 80px;
            margin-right: 10px;
        }
        
        .info-value {
            color: #1f2937;
            flex: 1;
        }
        
        .status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
        }
        
        .status-paid { background: #dcfce7; color: #16a34a; }
        .status-pending { background: #fef3c7; color: #d97706; }
        .status-overdue { background: #fee2e2; color: #dc2626; }
        .status-draft { background: #f3f4f6; color: #6b7280; }
        
        /* Items Table */
        .items-section {
            margin: 30px 0;
        }
        
        .items-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        
        .items-table th {
            background: #f9fafb;
            padding: 12px 8px;
            text-align: left;
            font-size: 11px;
            font-weight: 600;
            color: #374151;
            text-transform: uppercase;
            border-bottom: 2px solid #e5e7eb;
        }
        
        .items-table td {
            padding: 12px 8px;
            border-bottom: 1px solid #f3f4f6;
            vertical-align: top;
        }
        
        .items-table tbody tr:hover {
            background: #f9fafb;
        }
        
        .item-description {
            font-weight: 500;
            color: #1f2937;
            margin-bottom: 2px;
        }
        
        .item-details {
            font-size: 10px;
            color: #6b7280;
        }
        
        .text-right {
            text-align: right;
        }
        
        .text-center {
            text-align: center;
        }
        
        /* Totals Section */
        .totals-section {
            display: flex;
            justify-content: flex-end;
            margin-top: 20px;
        }
        
        .totals-table {
            width: 300px;
        }
        
        .totals-table tr {
            border-bottom: 1px solid #f3f4f6;
        }
        
        .totals-table td {
            padding: 8px 12px;
        }
        
        .total-label {
            font-weight: 500;
            color: #6b7280;
        }
        
        .total-amount {
            text-align: right;
            font-weight: 600;
            color: #1f2937;
        }
        
        .grand-total {
            background: #f9fafb;
            border-top: 2px solid #2563eb;
        }
        
        .grand-total .total-label {
            font-weight: 700;
            color: #1f2937;
            font-size: 14px;
        }
        
        .grand-total .total-amount {
            font-weight: 700;
            color: #2563eb;
            font-size: 16px;
        }
        
        /* Notes Section */
        .notes-section {
            margin: 30px 0;
        }
        
        .notes-content {
            background: #f9fafb;
            padding: 15px;
            border-radius: 6px;
            border-left: 4px solid #2563eb;
            font-size: 11px;
            line-height: 1.5;
        }
        
        /* Footer Section */
        .invoice-footer {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #e5e7eb;
            text-align: center;
        }
        
        .footer-company {
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 5px;
        }
        
        .footer-tagline {
            color: #6b7280;
            font-size: 11px;
            margin-bottom: 10px;
        }
        
        .footer-contact {
            font-size: 10px;
            color: #9ca3af;
            line-height: 1.3;
        }
        
        .footer-generated {
            margin-top: 15px;
            font-size: 9px;
            color: #9ca3af;
            font-style: italic;
        }
        
        /* Print Button */
        .print-button {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #2563eb;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
            z-index: 1000;
        }
        
        .print-button:hover {
            background: #1d4ed8;
        }
        
        /* Watermark for Cancelled Invoices */
        .watermark {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(-45deg);
            font-size: 120px;
            font-weight: 900;
            color: rgba(220, 38, 38, 0.15);
            z-index: 1000;
            pointer-events: none;
            text-transform: uppercase;
            letter-spacing: 20px;
            user-select: none;
        }
        
        .status-cancelled { 
            background: #fee2e2; 
            color: #dc2626; 
        }

        #invoice-container {
            width: 100%;
            max-width: 21cm;
            margin: 80px auto;
            background: white;
        }

        /* Print Styles */
        @media print {
            .print-button {
                display: none;
            }
            
            body {
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
                margin:0 !important;
                background:white!important;
            }

            .print-header{
                display:none;
            }
            
            #invoice-container {
                box-shadow: none;
                padding:0;
                border:none;
                margin:0 !important;
            }
            
            .watermark {
                color: rgba(220, 38, 38, 0.2) !important;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .invoice-header {
                flex-direction: column;
                gap: 20px;
            }
            
            .invoice-meta {
                text-align: left;
            }
            
            .client-section {
                flex-direction: column;
                gap: 20px;
            }
            
            .client-info, .invoice-details {
                width: 100%;
            }
            
            .items-table {
                font-size: 10px;
            }
            
            .totals-section {
                justify-content: center;
            }
        }
    </style>
</head>
<body class="my-10 bg-gray-100">
    <div class="print-header py-2 px-5 fixed top-0 left-0 bg-white w-full border-b px-10 flex items-center justify-center">
       <div class="flex items-center justify-between max-w-3xl w-full">
        <h2 class="text-lg font-medium">
            Invoice Print Preview
        </h2>
        <button class="button-min-primary ml-auto" onclick="window.print()"> 
            Print Invoice
        </button>
        </div>
    </div>

    <!-- Watermark for Cancelled Invoices -->
    {% if invoice.status == 'cancelled' %}
    <div class="watermark">CANCELLED</div>
    {% endif %}

            <div id="invoice-container" class="p-8 border bg-white my-10">
                <!-- header -->
                <div class="grid grid-cols-2 gap-10 items-center">
                    <div class="flex flex-col justify-start items-start">
                       <div class="flex flex-col items-center justify-center">
                         <img src="{% static "images/logos/lyp-logo.jpeg" %}" alt="" class="w-28" />
                        <h2 class="text-lg font-semibold">{{ company_name|default:"Your Company Name" }}</h2>
                       </div>
                        <p class="text-xs text-gray-600 mt-1 font-medium">{{ company_address|default:"123 Business Street, City, State 12345" }}</p>
                        <p class="text-xs text-gray-600 mt-1 font-medium">Phone: {{ company_phone|default:"(855) 123-4567" }}</p>
                        <p class="text-xs text-gray-600 mt-1 font-medium">Email: {{ company_email|default:"info@company.com" }}</p>
                        <p class="text-xs text-gray-600 mt-1 font-medium">Website: {{ company_website }}</p> 
                    </div>
                    <div class="text-right space-y-1">
                        <h1 class="text-xl font-semibold moul-regular">វិក្កយបត្រ</h1>
                        <h1 class="text-2xl font-semibold uppercase">Invoice</h1>
                        <h3 class="font-medium text-gray-600 text-sm"># {{ invoice.invoice_number }}</h3>
                    </div>
                </div>
                <!-- header -->
                <!-- bill info -->
                <div class="grid grid-cols-2 mt-5 divide-x border-t border-b">
                    <div class="py-3">
                        <h3 class="text-xs font-normal  kh-content-bold">ព័ត៌មានវិក្កយបត្រ</h3>
                        <h3 class="text-sm font-medium mt-1">Invoice details</h3>

                        <div class="py-1 text-xs text-gray-600 flex items-center mt-2">
                            <div class="w-20 font-medium">Issued date: </div>
                            <span class="text-gray-800 font-medium">{{ invoice.issue_date|date:"d/m/Y" }}</span>
                        </div>
                        <div class="py-1 text-xs text-gray-600 flex items-center">
                            <div class="w-20 font-medium">Due date: </div>
                            <span class="text-gray-800 font-medium">{{ invoice.due_date|date:"d/m/Y" }}</span>
                        </div>

                        <div class="py-1 text-xs text-gray-600 flex items-center">
                            <div class="w-20 font-medium">Status : </div>
                            <siv class="text-gray-800 font-medium ">{{ invoice.get_status_display }}</span>
                            
                        </div>
                        {% if invoice.is_overdue %}
                        <div class="py-1 text-xs text-gray-600 flex items-center">
                            <div class="w-20 font-medium">Overdue:</div>
                            <div class="font-meduim" style="color: #dc2626; font-weight: 600;">{{ invoice.days_overdue }} days</div>
                        </div>
                        {% endif %}
                    </div>
                    <div class="py-3 px-3">
                        <h3 class="text-xs font-normal  kh-content-bold ">អ្នកទទួល</h3>
                        <h3 class="text-sm font-medium mt-1">Billed to</h3>
                        <div class="py-1 text-xs text-gray-600 flex items-center mt-2">
                            <div class="w-20 font-medium">Client name: </div>
                            <span class="text-gray-800 font-medium">{{ invoice.get_client_name }}</span>
                        </div>
                        <div class="py-1 text-xs text-gray-600 flex items-center">
                            <div class="w-20 font-medium">Client Type: </div>
                            <span class="text-gray-800 font-medium">{{ invoice.get_client_type_display|default:"Normal" }}</span>
                        </div>
                    </div>
                    
                </div>
                <!-- bill info -->
    
                <!-- service and items -->
    
                <div class="mt-10">
                    <table class="w-full text-left table-auto min-w-max">
                        <thead>
                            <tr class="border-t">
                                <th class="py-3 pr-4 pl-2 border-b border-blue-gray-100 bg-white">
                                    <div>
                                        <p class="block text-sm  font-normal leading-none text-gray-900 font-medium text-left kh-content-regular">
                                            ល.រ
                                        </p>
                                        <p class="block text-sm  font-normal leading-none text-gray-900 font-medium text-left mt-1">
                                            No 
                                        </p>
                                    </div>
                                </th>
                                <th class="py-3 pr-4 pl-2 border-b border-blue-gray-100 bg-white space-y-1">
                                    <p class="block text-sm  font-normal leading-none text-gray-900 font-medium text-left kh-content-regular">
                                        ទំនិញ និងសេវាកម្ម
                                    </p>
                                    <p class="block text-sm  font-normal leading-none text-gray-900 font-medium text-left">
                                        Items & Services
                                    </p>
                                </th>
    
                                <th class="py-3 px-4 border-b border-blue-gray-100 bg-white">
                                    <p class="block text-sm  font-normal leading-none text-gray-900 font-medium text-left kh-content-regular">
                                       ចំនួន
                                    </p>
                                    <p class="block text-sm font-normal leading-none text-gray-900 font-medium mt-1">
                                        Qty
                                    </p>
                                </th>
                                <th class="py-3 px-4 border-b border-blue-gray-100 bg-white ">
                                    <p class="block text-sm  font-normal leading-none text-gray-900 font-medium text-left kh-content-regular">
                                       តម្លៃរាយ
                                    </p>
                                    <p class="block text-sm font-normal leading-none text-gray-900 font-medium mt-1">
                                        Unit Price
                                    </p>
                                </th>
                                <th class="py-3 px-4 border-b border-blue-gray-100 bg-white">
                                     <p class="block text-sm  font-normal leading-none text-gray-900 font-medium text-right kh-content-regular">
                                       តម្លៃសរុប
                                    </p>
                                    <p class="block text-sm font-normal leading-none text-gray-900 font-medium text-right mt-1">
                                        Total
                                    </p>
                                </th>
    
                            </tr>
                        </thead>
                        <tbody>
                            {% for item in invoice.line_items.all %}
                            <tr>
                                <td class="py-4 pl-2 border-b border-blue-gray-50 w-auto">
                                    <p class="block font-sans text-sm antialiased font-medium leading-normal text-gray-900">
                                        {{forloop.counter}}
                                    </p>
                                </td>
                                <td class="py-4 pr-4 pl-2 border-b border-blue-gray-50">
                                    <p class="block font-sans text-sm antialiased font-medium leading-normal text-gray-900">
                                        {{ item.service_item.name }}
                                        {% if item.description %}
                                             {{ item.description }}
                                        {% endif %}
                                    </p>
                                </td>
                                <td class="p-4 border-b border-blue-gray-50">
                                    <p class="block font-sans text-sm antialiased font-normal leading-normal text-gray-900">
                                        {{ item.quantity }}
                                    </p>
                                </td>
                                <td class="p-4 border-b border-blue-gray-50 ">
                                    <p
                                        class="block font-sans text-sm antialiased font-normal leading-normal text-gray-900 text-left">
                                        ${{ item.unit_price|floatformat:2 }}
                                    </p>
                                </td>
                                <td class="p-4 border-b border-blue-gray-50 text-right">
                                    <p class="block font-sans text-sm antialiased font-normal leading-normal text-gray-900">
                                        ${{ item.total_amount|floatformat:2 }}
                                    </p>
                                </td>
                                
                            </tr>
                            {% endfor %}
                            
                            <tr>
                                <td colspan="3"></td>
                                <td class="py-3 border-b-2 border-blue-500 text-left text-sm font-semibold">
                                    <span class="kh-content-regular">
                                        សរុប
                                    </span>
                                    <span>/<span>
                                    <span>
                                        Subtotal
                                    </span>
                                </td>
                                <td class="p-3 border-b-2 border-blue-500 text-right">
                                    <p class="block  text-sm font-normal leading-normal text-gray-900 font-semibold">
                                        ${{ invoice.subtotal|floatformat:2 }}
                                    </p>
                                </td>
                            </tr>
                            {% if invoice.tax_amount > 0 %}
                            <tr>
                                <td colspan="3"></td>
                                <td class="py-3 border-b-2 border-blue-500 text-left text-sm font-semibold">
                                    <span class="kh-content-regular">
                                        ពន្ធ
                                    </span>
                                    <span>/<span>
                                    <span>
                                        Tax
                                    </span>
                                </td>
                                <td class="p-3 border-b-2 border-blue-500 text-right">
                                    <p class="block  text-sm font-normal leading-normal text-gray-900 font-semibold">
                                        ${{ invoice.tax_amount|floatformat:2 }}
                                    </p>
                                </td>
                            </tr>
                            {% endif %}
                            <tr>
                                <td colspan="3"></td>
                                <td class="py-3 border-b-2 border-blue-500 text-left text-sm font-semibold text-blue-500">
                                   <span class="kh-content-regular">
                                        សរុបរួម
                                    </span>
                                    <span>/<span>
                                    <span>
                                        Total
                                    <span>
                                </td>
                                <td class="p-3 border-b-2 border-blue-500 text-right">
                                    <p class="block text-sm font-normal leading-normal text-blue-500 font-semibold">
                                        ${{ invoice.total_amount|floatformat:2 }}
                                    </p>
                                </td>
                            </tr>
                    </table>
                </div>
                <!-- service and items -->

                <!--Signature-->
                <div class="mt-10 py-3 grid grid-cols-2 gap-10">
                    <div class="px-10">
                        <div class="h-20 border-b-2" style="border-color:black !important"></div>
                        <div class="flex items-start justify-center space-x-1 mt-3">
                            <span class="kh-content-regular">ហត្ថលេខា</span>
                            <span>/</span>
                            <span>Signature</span>
                        </div>
                    </div>
                    <div class="px-10">
                        <div class="h-20 border-b-2" style="border-color:black !important"></div>
                        <div class="flex items-start justify-center space-x-1 mt-3">
                            <span class="kh-content-regular">ហត្ថលេខា</span>
                            <span>/</span>
                            <span>Signature</span>
                        </div>
                    </div>
                </div>
                <!--Signature-->
                <!-- footer -->
                <div class="py-5 mt-28 flex justify-between border-t items-start" style="font-size: 10px !important;">
                    <div class="text-gray-600 space-y-1">
                        <div class="font-medium text-gray-800">{{ company_name|default:"Your Company Name" }}</div>
                        <p>{{ company_tagline|default:"Professional Services" }}</p>
                        <div class="pb-1 text-gray-600 flex items-center">
                            <span class="text-gray-600">{{ company_address|default:"123 Business Street, City, State 12345" }}</span>
                        </div>
                    </div>
                    <div>
    
                        <div class="text-gray-600 flex items-center">
                            <div class="w-14 font-medium">Phone: </div>
                            <span class="text-gray-800 font-medium">{{ company_phone|default:"(555) 123-4567" }}</span>
                        </div>
                        <div class=" text-gray-600 flex items-center">
                            <div class="w-14 font-medium">Email: </div>
                            <span class="text-gray-800 font-medium">{{ company_email|default:"info@company.com" }}</span>
                        </div>
                        <div class="text-gray-600 flex items-center">
                            <div class="w-14 font-medium">Website: </div>
                            <span class="text-gray-800 font-medium">{{ company_website }}</span>
                        </div>
                    </div>
                </div>
                <!-- footer -->
    
            </div>


    {% comment %} <div class="invoice-container">
        <!-- Header Section -->
        <div class="invoice-header">
            <div class="company-info">
                {% if company_logo %}
                <div class="company-logo">
                    <img src="{{ company_logo.url }}" alt="{{ company_name }} Logo" style="max-height: 60px; max-width: 200px; object-fit: contain;">
                </div>
                {% endif %}
                <div class="company-name">{{ company_name|default:"Your Company Name" }}</div>
                <div class="company-tagline">{{ company_tagline|default:"Professional Services" }}</div>
                <div class="company-details">
                    {{ company_address|default:"123 Business Street, City, State 12345" }}<br>
                    Phone: {{ company_phone|default:"(555) 123-4567" }} | Email: {{ company_email|default:"info@company.com" }}
                    {% if company_website %}<br>Website: {{ company_website }}{% endif %}
                    {% if company_registration_number %}<br>Reg. No: {{ company_registration_number }}{% endif %}
                </div>
            </div>
            <div class="invoice-meta">
                <div class="invoice-title">INVOICE</div>
                <div class="invoice-number"># {{ invoice.invoice_number }}</div>
                <div class="invoice-date">{{ invoice.issue_date|date:"F d, Y" }}</div>
            </div>
        </div>

        <!-- Body Section -->
        <div class="invoice-body">
            <!-- Client Information -->
            <div class="client-section">
                <div class="client-info">
                    <div class="section-title">Bill To</div>
                    <div class="info-row">
                        <div class="info-label">Client:</div>
                        <div class="info-value">{{ invoice.get_client_name }}</div>
                    </div>
                    <div class="info-row">
                        <div class="info-label">Type:</div>
                        <div class="info-value">{{ invoice.get_client_type_display }}</div>
                    </div>
                    {% if invoice.client_address %}
                    <div class="info-row">
                        <div class="info-label">Address:</div>
                        <div class="info-value">{{ invoice.client_address }}</div>
                    </div>
                    {% endif %}
                    {% if invoice.client_contact %}
                    <div class="info-row">
                        <div class="info-label">Contact:</div>
                        <div class="info-value">{{ invoice.client_contact }}</div>
                    </div>
                    {% endif %}
                </div>

                <div class="invoice-details">
                    <div class="section-title">Invoice Details</div>
                    <div class="info-row">
                        <div class="info-label">Issue Date:</div>
                        <div class="info-value">{{ invoice.issue_date|date:"M d, Y" }}</div>
                    </div>
                    <div class="info-row">
                        <div class="info-label">Due Date:</div>
                        <div class="info-value">{{ invoice.due_date|date:"M d, Y" }}</div>
                    </div>
                    <div class="info-row">
                        <div class="info-label">Status:</div>
                        <div class="info-value">
                            <span class="status-badge status-{{ invoice.status }}">{{ invoice.get_status_display }}</span>
                        </div>
                    </div>
                    {% if invoice.is_overdue %}
                    <div class="info-row">
                        <div class="info-label">Overdue:</div>
                        <div class="info-value" style="color: #dc2626; font-weight: 600;">{{ invoice.days_overdue }} days</div>
                    </div>
                    {% endif %}
                </div>
            </div>

            <!-- Items Section -->
            <div class="items-section">
                <div class="section-title">Items & Services</div>
                {% if invoice.line_items.all %}
                <table class="items-table">
                    <thead>
                        <tr>
                            <th style="width: 50%;">Description</th>
                            <th class="text-center" style="width: 15%;">Qty</th>
                            <th class="text-right" style="width: 17.5%;">Unit Price</th>
                            <th class="text-right" style="width: 17.5%;">Total</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for item in invoice.line_items.all %}
                        <tr>
                            <td>
                                <div class="item-description">{{ item.service_item.name }}</div>
                                {% if item.description %}
                                <div class="item-details">{{ item.description }}</div>
                                {% endif %}
                            </td>
                            <td class="text-center">{{ item.quantity }}</td>
                            <td class="text-right">${{ item.unit_price|floatformat:2 }}</td>
                            <td class="text-right">${{ item.total_amount|floatformat:2 }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
                {% else %}
                <div style="text-align: center; padding: 40px; color: #6b7280; font-style: italic;">
                    No items found for this invoice.
                </div>
                {% endif %}
            </div>

            <!-- Totals Section -->
            <div class="totals-section">
                <table class="totals-table">
                    <tr>
                        <td class="total-label">Subtotal:</td>
                        <td class="total-amount">${{ invoice.subtotal|floatformat:2 }}</td>
                    </tr>
                    {% if invoice.tax_amount > 0 %}
                    <tr>
                        <td class="total-label">Tax:</td>
                        <td class="total-amount">${{ invoice.tax_amount|floatformat:2 }}</td>
                    </tr>
                    {% endif %}
                    {% if invoice.discount_amount > 0 %}
                    <tr>
                        <td class="total-label">Discount:</td>
                        <td class="total-amount">-${{ invoice.discount_amount|floatformat:2 }}</td>
                    </tr>
                    {% endif %}
                    <tr class="grand-total">
                        <td class="total-label">TOTAL:</td>
                        <td class="total-amount">${{ invoice.total_amount|floatformat:2 }}</td>
                    </tr>
                </table>
            </div>

            <!-- Notes Section -->
            {% if invoice.notes or invoice.terms_and_conditions %}
            <div class="notes-section">
                {% if invoice.terms_and_conditions %}
                <div class="section-title">Terms & Conditions</div>
                <div class="notes-content">{{ invoice.terms_and_conditions|linebreaks }}</div>
                {% endif %}
                
                {% if invoice.notes %}
                <div class="section-title" style="margin-top: 20px;">Notes</div>
                <div class="notes-content">{{ invoice.notes|linebreaks }}</div>
                {% endif %}
            </div>
            {% endif %}
        </div>

        <!-- Footer Section -->
        <div class="invoice-footer">
            <div class="footer-company">{{ company_name|default:"Your Company Name" }}</div>
            <div class="footer-tagline">{{ company_tagline|default:"Thank you for your business!" }}</div>
            <div class="footer-contact">
                {{ company_address|default:"123 Business Street, City, State 12345" }}<br>
                Phone: {{ company_phone|default:"(555) 123-4567" }} | Email: {{ company_email|default:"info@company.com" }}
                {% if company_website %}<br>Website: {{ company_website }}{% endif %}
            </div>
            <div class="footer-generated">
                Invoice generated on {{ "now"|date:"F d, Y \a\\t g:i A" }}
            </div>
        </div>
    </div> {% endcomment %}
</body>
</html>