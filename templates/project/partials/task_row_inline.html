<!-- Inline Editable Task Row -->
<tr id="task-{{ task.id }}" class="task-row"
    data-status="{{ task.status }}"
    data-assignee="{{ task.assigned_to.id|default:'' }}">
    <td>
        <div>
            <input type="text"
                   class="form-control-inline"
                   value="{{ task.task_name }}"
                   data-task-id="{{ task.id }}"
                   data-field="task_name"
                   placeholder="Task name..."
                   style="font-weight: 500;">
            <small style="font-size: 10px; color: #6b7280;">{{ task.task_code }}</small>
        </div>
    </td>
    <td>
        <div class="assignee-autocomplete-wrapper">
            <input type="text"
                   class="assignee-autocomplete-input"
                   data-task-id="{{ task.id }}"
                   data-field="assigned_to"
                   data-employee-id="{{ task.assigned_to.id|default:'' }}"
                   value="{% if task.assigned_to %}{{ task.assigned_to.user.get_full_name }}{% else %}{% endif %}"
                   placeholder="Type to search employee..."
                   autocomplete="off">
            <div class="assignee-autocomplete-dropdown"></div>
        </div>
    </td>
    <td>
        <select class="form-control-inline"
                data-task-id="{{ task.id }}"
                data-field="status">
            <option value="open" {% if task.status == 'open' %}selected{% endif %}>Open</option>
            <option value="working" {% if task.status == 'working' %}selected{% endif %}>Working</option>
            <option value="pending_review" {% if task.status == 'pending_review' %}selected{% endif %}>Pending Review</option>
            <option value="completed" {% if task.status == 'completed' %}selected{% endif %}>Completed</option>
            <option value="overdue" {% if task.status == 'overdue' %}selected{% endif %}>Overdue</option>
            <option value="cancelled" {% if task.status == 'cancelled' %}selected{% endif %}>Cancelled</option>
        </select>
    </td>
    <td>
        <select class="form-control-inline"
                data-task-id="{{ task.id }}"
                data-field="priority">
            <option value="low" {% if task.priority == 'low' %}selected{% endif %}>Low</option>
            <option value="medium" {% if task.priority == 'medium' %}selected{% endif %}>Medium</option>
            <option value="high" {% if task.priority == 'high' %}selected{% endif %}>High</option>
            <option value="urgent" {% if task.priority == 'urgent' %}selected{% endif %}>Urgent</option>
        </select>
    </td>
    <td>
        <input type="number"
               class="form-control-inline"
               value="{{ task.progress|floatformat:0 }}"
               data-task-id="{{ task.id }}"
               data-field="progress"
               min="0"
               max="100"
               step="5"
               placeholder="0">
    </td>
    <td>
        <input type="date"
               class="form-control-inline"
               value="{{ task.expected_end_date|date:'Y-m-d' }}"
               data-task-id="{{ task.id }}"
               data-field="expected_end_date">
        {% if task.expected_end_date and task.expected_end_date < today and task.status not in 'completed,cancelled' %}
            <small style="font-size: 10px; color: #ef4444;">Overdue</small>
        {% endif %}
    </td>
    <td>
        <button type="button" class="btn-icon-sm danger delete-task-btn"
                data-task-id="{{ task.id }}"
                title="Delete task">
            <i class="bi bi-trash"></i>
        </button>
    </td>
</tr>
