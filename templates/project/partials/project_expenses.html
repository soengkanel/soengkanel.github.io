<!-- Project Expenses Tab -->
<style>
/* Expenses content styles */
.expenses-content {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
}

.action-bar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 0.75rem;
}

.card {
    background: #ffffff;
    border: 1px solid #e5e5e5;
    border-radius: 4px;
}

.card-body {
    padding: 0.75rem;
}

.table-responsive {
    overflow-x: auto;
}

.table {
    width: 100%;
    margin: 0;
    border-collapse: collapse;
}

.table thead th {
    font-size: 0.6875rem;
    font-weight: 600;
    color: #666;
    padding: 0.5rem 0.625rem;
    text-align: left;
    border-bottom: 1px solid #e5e5e5;
    background: #f9f9f9;
}

.table tbody td {
    font-size: 0.75rem;
    color: #1a1a1a;
    padding: 0.625rem;
    border-bottom: 1px solid #f5f5f5;
}

.table tbody tr:hover {
    background: #f9f9f9;
}

.table tbody tr:last-child td {
    border-bottom: none;
}

.expense-description {
    font-size: 0.6875rem;
    color: #666;
    margin-top: 0.125rem;
}

.expense-tags {
    display: flex;
    flex-direction: column;
    gap: 0.125rem;
    margin-top: 0.25rem;
}

.expense-tag {
    font-size: 0.6875rem;
}

.badge {
    display: inline-block;
    padding: 0.125rem 0.5rem;
    border-radius: 3px;
    font-size: 0.6875rem;
    font-weight: 500;
}

.badge-pending {
    background: #fef3c7;
    color: #92400e;
}

.badge-submitted {
    background: #dbeafe;
    color: #1e40af;
}

.badge-approved {
    background: #d1fae5;
    color: #065f46;
}

.badge-rejected {
    background: #fee2e2;
    color: #991b1b;
}

.badge-paid {
    background: #e0e7ff;
    color: #3730a3;
}

.btn-group {
    display: inline-flex;
    gap: 0.25rem;
}

.empty-state {
    text-align: center;
    padding: 2.5rem 1rem;
}

.empty-icon {
    width: 48px;
    height: 48px;
    margin: 0 auto 0.75rem;
    color: #999;
}

.empty-title {
    font-size: 0.875rem;
    font-weight: 600;
    color: #1a1a1a;
    margin: 0 0 0.25rem 0;
}

.empty-description {
    font-size: 0.75rem;
    color: #999;
    margin: 0 0 1rem 0;
}

/* Expense summary stats */
.expense-stats {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 0.75rem;
    margin-top: 0.75rem;
}

.stat-card {
    padding: 0.625rem 0.75rem;
    border-radius: 3px;
    border: 1px solid #f0f0f0;
    background: #f9f9f9;
}

.stat-number {
    font-size: 1.25rem;
    font-weight: 600;
    line-height: 1;
    margin-bottom: 0.25rem;
}

.stat-label {
    font-size: 0.6875rem;
    color: #666;
}
</style>

<div class="expenses-content">
    <div class="action-bar justify-content-end">
            <a href="{% url 'project:expense_create' project.id %}" class="button-min-primary py-1">
                <div class="align-items-center space-x-1">
                    <i class="fas fa-plus"></i>
                    Add
                </div>
            </a>
    </div>

    <div class="card">
        <div class="card-body">
            {% if expenses %}
                <div class="table-responsive">
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th>Expense Code</th>
                                <th>Description</th>
                                <th>Amount</th>
                                <th>Employee</th>
                                <th>Date</th>
                                <th>Status</th>
                                <th style="width: 100px;">Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for expense in expenses %}
                            <tr>
                                <td style="font-weight: 500;">{{ expense.expense_code }}</td>
                                <td>
                                    <div style="font-weight: 500;">{{ expense.expense_type|default:'General' }}</div>
                                    {% if expense.description %}
                                        <div class="expense-description">{{ expense.description|truncatewords:10 }}</div>
                                    {% endif %}
                                    <div class="expense-tags">
                                        {% if expense.is_billable %}
                                            <span class="expense-tag" style="color: #16a34a;">Billable</span>
                                        {% endif %}
                                        {% if expense.is_reimbursable %}
                                            <span class="expense-tag" style="color: #0284c7;">Reimbursable</span>
                                        {% endif %}
                                    </div>
                                </td>
                                <td style="font-weight: 600;">${{ expense.amount|floatformat:2 }}</td>
                                <td>{{ expense.employee.user.get_full_name }}</td>
                                <td>{{ expense.expense_date|date:"M d, Y" }}</td>
                                <td>
                                    <span class="badge badge-{{ expense.status }}">
                                        {{ expense.get_status_display }}
                                    </span>
                                </td>
                                <td>
                                    <div class="btn-group">
                                        <button class="btn btn-outline-primary btn-sm" title="Edit">
                                            <svg style="width: 14px; height: 14px;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                                            </svg>
                                        </button>
                                        {% if expense.status == 'submitted' %}
                                            <button class="btn btn-outline-primary btn-sm" title="Approve">
                                                <svg style="width: 14px; height: 14px;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                                </svg>
                                            </button>
                                        {% endif %}
                                        <button class="btn btn-outline-danger btn-sm" title="Delete">
                                            <svg style="width: 14px; height: 14px;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                            </svg>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>

                <!-- Summary Stats -->
                <div class="expense-stats">
                    <div class="stat-card">
                        <div class="stat-number" style="color: #2563eb;">${{ expense_stats.total|floatformat:2 }}</div>
                        <div class="stat-label">Total Expenses</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" style="color: #16a34a;">${{ expense_stats.billable|floatformat:2 }}</div>
                        <div class="stat-label">Billable</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" style="color: #059669;">${{ expense_stats.approved|floatformat:2 }}</div>
                        <div class="stat-label">Approved</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" style="color: #ea580c;">{{ expense_stats.submitted_count }}</div>
                        <div class="stat-label">Pending Approval</div>
                    </div>
                </div>
            {% else %}
                <div class="empty-state">
                    <svg class="empty-icon" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1" />
                    </svg>
                    <h3 class="empty-title">No expenses yet</h3>
                    <p class="empty-description">Track project expenses for better budget management.</p>
                </div>
            {% endif %}
        </div>
    </div>
</div>
