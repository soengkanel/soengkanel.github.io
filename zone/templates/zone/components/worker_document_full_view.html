{% comment %} <!-- Modal -->
<div id="imageModal" class="fixed inset-0 z-50 hidden overflow-y-auto">
  <div
    class="flex items-center justify-center min-h-screen pt-2 px-4 pb-10 text-center sm:block sm:p-0"
  >
    <!-- Background overlay -->
    <div class="fixed inset-0 transition-opacity" aria-hidden="true">
      <div
        class="absolute inset-0 bg-black opacity-75"
        onclick="closeModal()"
      ></div>
    </div>

    <!-- Modal content -->
    <div
      class="inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full"
    >
    <div class="border-b flex justify-between items-center">
      <h2 class="eading-6 font-medium text-gray-900 py-2 px-3" style="font-size: 1rem;">
       Document Full View
      </h2>
      <button
          type="button"
          class="mt-1 w-full inline-flex justify-center rounded-md  px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm"
          onclick="closeModal()"
        >
          <i class="bi bi-x-lg"></i>
        </button>
    </div>
    <div class="border">
      <div class="bg-white px-4 pt-1 pb-4 sm:p-6 sm:pb-4">
        <div class="sm:flex sm:items-start">
          <div class="mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full ">
          
            <div class="mt-0">
              <img id="modalImage" class="w-full rounded-lg" src="" alt="" />
            </div>
          </div>
        </div>
      </div>
      <div class="bg-gray-50 px-4 py-2 sm:px-6 sm:flex sm:flex-row-reverse">
        <button
          type="button"
          class="button-min-default"
          onclick="closeModal()"
        >
          Close
        </button>
      </div>
    </div>
  </div>
</div>

<script>
  // Open modal with image
  function openModal(imageSrc, title) {
    const modal = document.getElementById("imageModal");
    const modalImage = document.getElementById("modalImage");
    const modalTitle = document.getElementById("modalTitle");

    modal.classList.remove("hidden");
    modalImage.src = imageSrc;
    modalTitle.textContent = title;

    // Prevent body scrolling when modal is open
    document.body.style.overflow = "hidden";
  }

  // Close modal
  function closeModal() {
    const modal = document.getElementById("imageModal");
    modal.classList.add("hidden");

    // Restore body scrolling
    document.body.style.overflow = "auto";
  }

  // Close modal when pressing Escape key
  document.addEventListener("keydown", function (event) {
    const modal = document.getElementById("imageModal");
    if (event.key === "Escape" && !modal.classList.contains("hidden")) {
      closeModal();
    }
  });
</script> {% endcomment %}
<style>
  .cursor-zoom-in{
    cursor: zoom-in;
  }
  .cursor-zoom-out{
    cursor: zoom-out;
  }
</style>
<!-- Modal -->
<div id="imageModal" class="fixed inset-0 z-50 hidden overflow-y-auto">
  <div class="flex items-center justify-center min-h-screen pt-0 px-4 pb-20 text-center sm:block sm:p-0">
      <!-- Background overlay -->
      <div class="fixed inset-0 transition-opacity" aria-hidden="true">
          <div class="absolute inset-0 bg-black opacity-75" onclick="closeModal()"></div>
      </div>
      
      <!-- Modal content -->
      <div class="inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full">
        <div class="border-b flex justify-between items-center py-2 px-3">
          <h2 class="eading-6 font-medium text-gray-900 " style="font-size: 1rem;">
            Document Full View
          </h2>
          <button type="button" class="border-none shadow-none hover:text-gray-700" onclick="closeModal()">
            <i class="bi bi-x-lg"></i>
          </button>
        </div>
        <div class="py-2 px-3 flex justify-start space-x-2 items-center bg-blue-50">
            <i class="bi bi-exclamation-circle text-blue-500" style="font-size: 1rem;"></i>
            <span class="text-blue-500 text-xs font-medium">
               Click on the image to zoom
            </span>
        </div>
        <div class="bg-white px-4 pt-0 pb-4 sm:p-6 sm:pb-4">
              <div class="sm:flex sm:items-center">
                  <div class="mt-2 text-center w-full">
                      
                      <div class="mt-0 relative overflow-hidden rounded" style="height: 70vh;">
                          <img 
                              id="modalImage" 
                              class="w-full h-full object-contain cursor-zoom-in" 
                              src="" 
                              alt=""
                              onclick="toggleZoom(this)"
                              onmousemove="panImage(event, this)"
                          >
                      </div>
                  </div>
              </div>
          </div>
          <div class="bg-gray-50 px-4 py-2 flex justify-end space-x-2">
             
              <button 
                  type="button" 
                  class="mt-1 button-min-default"
                  onclick="resetZoom()"
              >
                  Reset Zoom
              </button>
              <button 
              type="button" 
              class="mt-1 button-min-default"
              onclick="closeModal()"
          >
              Close
          </button>
          </div>
      </div>
  </div>
</div>

<script>
  let isZoomed = false;
  let currentTransform = '';
  
  // Open modal with image
  function openModal(imageSrc, title) {
      const modal = document.getElementById('imageModal');
      const modalImage = document.getElementById('modalImage');
      const modalTitle = document.getElementById('modalTitle');
      
      modal.classList.remove('hidden');
      modalImage.src = imageSrc;
      modalTitle.textContent = title;
      
      // Reset zoom state when opening new image
      isZoomed = false;
      modalImage.style.transform = '';
      modalImage.classList.remove('cursor-zoom-out');
      modalImage.classList.add('cursor-zoom-in');
      
      // Prevent body scrolling when modal is open
      document.body.style.overflow = 'hidden';
  }
  
  // Close modal
  function closeModal() {
      const modal = document.getElementById('imageModal');
      modal.classList.add('hidden');
      
      // Restore body scrolling
      document.body.style.overflow = 'auto';
  }
  
  // Toggle zoom on click
  function toggleZoom(img) {
      const container = img.parentElement;
      
      if (!isZoomed) {
          // Zoom in
          const scaleX = container.offsetWidth / img.naturalWidth;
          const scaleY = container.offsetHeight / img.naturalHeight;
          const scale = Math.min(scaleX, scaleY);
          
          img.style.transform = `scale(${2})`; // Zoom to 2x
          img.classList.remove('cursor-zoom-in');
          img.classList.add('cursor-zoom-out');
          isZoomed = true;
          currentTransform = `scale(${2})`;
      } else {
          // Zoom out
          img.style.transform = '';
          img.classList.remove('cursor-zoom-out');
          img.classList.add('cursor-zoom-in');
          isZoomed = false;
          currentTransform = '';
      }
  }
  
  // Pan image when zoomed
  function panImage(event, img) {
      if (!isZoomed) return;
      
      const container = img.parentElement;
      const rect = container.getBoundingClientRect();
      
      // Calculate mouse position relative to container
      const x = event.clientX - rect.left;
      const y = event.clientY - rect.top;
      
      // Calculate percentage position
      const xPercent = (x / rect.width) * 100;
      const yPercent = (y / rect.height) * 100;
      
      // Update transform origin
      img.style.transformOrigin = `${xPercent}% ${yPercent}%`;
  }
  
  // Reset zoom to original size
  function resetZoom() {
      const img = document.getElementById('modalImage');
      img.style.transform = '';
      img.classList.remove('cursor-zoom-out');
      img.classList.add('cursor-zoom-in');
      isZoomed = false;
      currentTransform = '';
  }
  
  // Close modal when pressing Escape key
  document.addEventListener('keydown', function(event) {
      const modal = document.getElementById('imageModal');
      if (event.key === 'Escape' && !modal.classList.contains('hidden')) {
          closeModal();
      }
  });
</script>