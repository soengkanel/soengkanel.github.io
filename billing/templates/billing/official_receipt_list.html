{% extends 'base/base.html' %}
{% load static %}

{% block title %}Official Receipts{% endblock %}

{% block extra_css %}
{% include 'includes/compact_ui.html' %}
<style>
/* Receipt-specific compact styles */
.table-actions {
    display: flex;
    gap: var(--space-1);
    align-items: center;
}

.btn-sm {
    font-size: var(--text-xs);
    padding: var(--space-1) var(--space-2);
    border-radius: var(--radius);
    text-decoration: none;
    font-weight: 500;
    transition: var(--transition);
    border: 1px solid transparent;
}

.btn-view {
    background: var(--primary);
    color: var(--white);
}

.btn-view:hover {
    background: var(--primary-dark);
    color: var(--white);
}

.btn-edit {
    background: var(--gray-100);
    color: var(--gray-700);
    border-color: var(--gray-200);
}

.btn-edit:hover {
    background: var(--gray-200);
    color: var(--black);
}

.btn-print {
    background: var(--success);
    color: var(--white);
}

.btn-print:hover {
    background: #047857;
    color: var(--white);
}

/* Status badges */
.status-badge {
    font-size: var(--text-xs);
    font-weight: 600;
    padding: var(--space-1) var(--space-2);
    border-radius: var(--radius);
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.status-completed { background: var(--success-light); color: var(--success); }
.status-pending { background: var(--warning-light); color: var(--warning); }
.status-cancelled { background: var(--gray-200); color: var(--gray-600); }

.filter-pill{
    border-radius:8px !important;
    padding:2px 10px;
    border: 1px solid rgba(27, 31, 35, 0.15);
    border-radius: 11px;
    box-shadow: rgba(213, 217, 217, .5) 0 2px 5px 0;
}

.filter-pill:hover{
    background: linear-gradient(180deg, oklch(74.6% 0.16 232.661) 0%, oklch(68.5% 0.169 237.323) 100%);
    background-origin: border-box;
    box-shadow: 0px 0.5px 1.5px rgba(54, 122, 246, 0.25), inset 0px 0.8px 0px -0.25px rgba(255, 255, 255, 0.2);
    color:#ffffff;
}

.filter-pill.active{
    background: linear-gradient(180deg, oklch(74.6% 0.16 232.661) 0%, oklch(68.5% 0.169 237.323) 100%);
    background-origin: border-box;
    box-shadow: 0px 0.5px 1.5px rgba(54, 122, 246, 0.25), inset 0px 0.8px 0px -0.25px rgba(255, 255, 255, 0.2);
    color:#ffffff;
}

.form-control{
    border-radius:8px;
    padding:7px 5px;
}
</style>
{% endblock %}

{% block content %}
<div class="page-container">
    <!-- Page Header -->
    <div class="page-header">
        <div class="page-header-center">
            <h1 class="page-title">
               
                Official Receipts
            </h1>
            <p class="page-subtitle">Manage and track all receipt records</p>
        </div>
        <div class="header-actions">
            <a href="{% url 'billing:official_receipt_create' %}" class="button-min-primary">
               <div>
                <i class="fa fa-plus me-1"></i>
                New Receipt
               </div>
            </a>
        </div>
    </div>

    <!-- Filters Section -->
    <div class="filters-section">
        <!-- Quick Filters -->
        <div class="quick-filters">
            <a href="?status=" class="filter-pill {% if not request.GET.status %}active{% endif %}">All</a>
            <a href="?status=completed" class="filter-pill {% if request.GET.status == 'completed' %}active{% endif %}">Completed</a>
            <a href="?status=pending" class="filter-pill {% if request.GET.status == 'pending' %}active{% endif %}">Pending</a>
            <a href="?status=cancelled" class="filter-pill {% if request.GET.status == 'cancelled' %}active{% endif %}">Cancelled</a>
        </div>

        <!-- Search Form -->
        <form method="get" class="form-row">
            <div class="form-group">
                <label for="search" class="form-label">Search</label>
                <input type="text" id="search" name="search" class="form-control" 
                       placeholder="Receipt number, client name..." 
                       value="{{ request.GET.search }}">
            </div>
            <div class="form-group">
                <label for="date_from" class="form-label">From Date</label>
                <input type="date" id="date_from" name="date_from" class="form-control" 
                       value="{{ request.GET.date_from }}">
            </div>
            <div class="form-group">
                <label for="date_to" class="form-label">To Date</label>
                <input type="date" id="date_to" name="date_to" class="form-control" 
                       value="{{ request.GET.date_to }}">
            </div>
            <div class="form-group">
                <button type="submit" class="button-min-primary">
                    <div>
                        <i class="bi bi-search"></i>
                    Search
                    </div>
                </button>
            </div>
        </form>
    </div>

    <!-- Receipt Table -->
    <div class="table-container">
        <table class="table-compact">
            <thead>
                <tr>
                    <th>Receipt #</th>
                    <th>Received From</th>
                    <th>Date</th>
                    <th>Amount</th>
                    <th>Purpose</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for receipt in receipts %}
                <tr>
                    <td>
                        <strong>{{ receipt.receipt_number }}</strong>
                    </td>
                    <td>{{ receipt.received_from }}</td>
                    <td>{{ receipt.date|date:"M d, Y" }}</td>
                    <td><strong>${{ receipt.amount|floatformat:2 }}</strong></td>
                    <td>{{ receipt.purpose|truncatechars:30 }}</td>
                    <td>
                        <div class="table-actions">
                            <a href="{% url 'billing:official_receipt_detail' receipt.id %}" class="btn-sm button-min-primary">
                                <i class="bi bi-eye"></i>
                              
                            </a>
                            <a href="{% url 'billing:official_receipt_edit' receipt.id %}" class="btn-sm button-min-default">
                                <i class="bi bi-pencil"></i>
                                
                            </a>
                            <a href="{% url 'billing:official_receipt_print' receipt.id %}" class="btn-sm button-min-primary" target="_blank">
                                <i class="bi bi-printer"></i>
                              
                            </a>
                        </div>
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="6" style="text-align: center; padding: var(--space-8); color: var(--gray-500);">
                        <div class="empty-state bg-transparent border-none shadow-none">
                            <i class="bi bi-receipt" style="font-size: 2rem; color: var(--gray-300); margin-bottom: var(--space-2);"></i>
                            <p>No receipts found.</p>
                           <div class="flex justify-center w-full mt-2">
                                <a href="{% url 'billing:official_receipt_create' %}" class="button-min-primary">
                                    <div>
                                        <i class="bi bi-plus"></i>
                                    Create your first receipt
                                    </div>
                                </a>
                            </div>
                        </div>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- Pagination -->
    {% if receipts.has_other_pages %}
    <div class="pagination-container">
        <div class="pagination">
            {% if receipts.has_previous %}
                <a href="?page=1{% if request.GET.search %}&search={{ request.GET.search }}{% endif %}{% if request.GET.status %}&status={{ request.GET.status }}{% endif %}">« First</a>
                <a href="?page={{ receipts.previous_page_number }}{% if request.GET.search %}&search={{ request.GET.search }}{% endif %}{% if request.GET.status %}&status={{ request.GET.status }}{% endif %}">‹ Previous</a>
            {% endif %}

            <span class="current">
                Page {{ receipts.number }} of {{ receipts.paginator.num_pages }}
            </span>

            {% if receipts.has_next %}
                <a href="?page={{ receipts.next_page_number }}{% if request.GET.search %}&search={{ request.GET.search }}{% endif %}{% if request.GET.status %}&status={{ request.GET.status }}{% endif %}">Next ›</a>
                <a href="?page={{ receipts.paginator.num_pages }}{% if request.GET.search %}&search={{ request.GET.search }}{% endif %}{% if request.GET.status %}&status={{ request.GET.status }}{% endif %}">Last »</a>
            {% endif %}
        </div>
    </div>
    {% endif %}
</div>
{% endblock %} 