<!-- Mermaid.js for diagrams -->
<script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        // Convert ```mermaid code blocks to divs
        document.querySelectorAll('pre code.language-mermaid').forEach(function (block) {
            const pre = block.parentElement;
            const div = document.createElement('div');
            div.className = 'mermaid';
            div.textContent = block.textContent;
            pre.parentElement.replaceChild(div, pre);
        });

        // Initialize Mermaid with theme
        const theme = document.documentElement.getAttribute('data-theme') || 'light';
        mermaid.initialize({
            startOnLoad: true,
            theme: theme === 'dark' ? 'dark' : 'default'
        });
    });
</script>