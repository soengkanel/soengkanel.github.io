{% extends 'base/base.html' %}
{% load static %}

{% block title %}Dashboard - NextHR{% endblock %}

{% block extra_css %}
<style>
.dashboard-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 1rem;
}

.dashboard-header {
    margin-bottom: 2rem;
}

.dashboard-title {
    font-size: 1.75rem;
    font-weight: 700;
    color: #1f2937;
    margin: 0;
}

.dashboard-subtitle {
    color: #6b7280;
    font-size: 0.875rem;
    margin: 0.25rem 0 0 0;
}

/* Quick Actions Bar */
.quick-actions {
    background: white;
    border: 1px solid #e5e7eb;
    border-radius: 8px;
    padding: 1rem;
    margin-bottom: 2rem;
}

.quick-actions h3 {
    font-size: 1rem;
    font-weight: 600;
    color: #374151;
    margin: 0 0 1rem 0;
}

.actions-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
    gap: 0.75rem;
}

.action-card {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    background: #f8fafc;
    border: 1px solid #e5e7eb;
    border-radius: 6px;
    padding: 0.875rem;
    text-decoration: none;
    transition: all 0.2s;
}

.action-card:hover {
    background: #f1f5f9;
    border-color: #3b82f6;
    text-decoration: none;
}

.action-icon {
    width: 32px;
    height: 32px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 14px;
    color: white;
    flex-shrink: 0;
}

.icon-primary { background: #3b82f6; }
.icon-success { background: #10b981; }
.icon-info { background: #0ea5e9; }
.icon-dark { background: #374151; }
.icon-secondary { background: #6b7280; }

.action-text h4 {
    font-size: 0.875rem;
    font-weight: 600;
    color: #1f2937;
    margin: 0;
}

.action-text p {
    font-size: 0.75rem;
    color: #6b7280;
    margin: 0.125rem 0 0 0;
}

/* Stats Grid */
.stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1rem;
    margin-bottom: 2rem;
}

.stat-card {
    background: white;
    border: 1px solid #e5e7eb;
    border-radius: 8px;
    padding: 1.25rem;
    text-align: center;
}

.stat-value {
    font-size: 2rem;
    font-weight: 800;
    margin: 0 0 0.25rem 0;
}

.stat-label {
    font-size: 0.875rem;
    color: #6b7280;
    font-weight: 600;
    margin: 0 0 0.5rem 0;
}

.stat-detail {
    font-size: 0.75rem;
    color: #9ca3af;
    margin: 0;
}

.stat-primary { color: #3b82f6; }
.stat-success { color: #10b981; }
.stat-info { color: #0ea5e9; }
.stat-warning { color: #f59e0b; }
.stat-danger { color: #ef4444; }

/* Performance Indicators */
.performance-section {
    background: white;
    border: 1px solid #e5e7eb;
    border-radius: 8px;
    padding: 1.25rem;
    margin-bottom: 2rem;
}

.performance-title {
    font-size: 1rem;
    font-weight: 600;
    color: #374151;
    margin: 0 0 1rem 0;
}

.performance-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1rem;
}

.performance-item {
    text-align: center;
}

.performance-circle {
    width: 80px;
    height: 80px;
    border-radius: 50%;
    margin: 0 auto 0.75rem auto;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.125rem;
    font-weight: 700;
    color: white;
    position: relative;
}

.performance-circle::after {
    content: '';
    position: absolute;
    inset: 4px;
    border-radius: 50%;
    background: white;
    display: flex;
    align-items: center;
    justify-content: center;
}

.performance-percentage {
    position: relative;
    z-index: 1;
    color: inherit;
}

.performance-label {
    font-size: 0.875rem;
    font-weight: 600;
    color: #374151;
    margin: 0;
}

.circle-excellent { background: #10b981; }
.circle-good { background: #f59e0b; }
.circle-poor { background: #ef4444; }

/* Recent Activity */
.recent-activity {
    background: white;
    border: 1px solid #e5e7eb;
    border-radius: 8px;
    padding: 1.25rem;
}

.activity-title {
    font-size: 1rem;
    font-weight: 600;
    color: #374151;
    margin: 0 0 1rem 0;
}

.activity-list {
    list-style: none;
    padding: 0;
    margin: 0;
}

.activity-item {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 0.75rem 0;
    border-bottom: 1px solid #f3f4f6;
}

.activity-item:last-child {
    border-bottom: none;
}

.activity-icon {
    width: 28px;
    height: 28px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 12px;
    color: white;
    flex-shrink: 0;
}

.activity-content {
    flex: 1;
}

.activity-text {
    font-size: 0.875rem;
    color: #374151;
    margin: 0 0 0.125rem 0;
}

.activity-time {
    font-size: 0.75rem;
    color: #9ca3af;
    margin: 0;
}

/* Footer Status */
.dashboard-footer {
    text-align: center;
    padding: 1rem;
    color: #6b7280;
    font-size: 0.875rem;
}

.status-indicator {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    background: #dcfce7;
    color: #166534;
    padding: 0.25rem 0.5rem;
    border-radius: 4px;
    font-size: 0.75rem;
    font-weight: 600;
    margin-left: 0.5rem;
}

.status-dot {
    width: 6px;
    height: 6px;
    border-radius: 50%;
    background: #16a34a;
}

/* Responsive Design */
@media (max-width: 768px) {
    .dashboard-container {
        padding: 0.5rem;
    }
    
    .stats-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 0.75rem;
    }
    
    .actions-grid {
        grid-template-columns: 1fr;
    }
    
    .performance-grid {
        grid-template-columns: 1fr;
    }
    
    .stat-card {
        padding: 1rem;
    }
    
    .stat-value {
        font-size: 1.5rem;
    }
}

@media (max-width: 480px) {
    .dashboard-title {
        font-size: 1.5rem;
    }
    
    .stats-grid {
        grid-template-columns: 1fr;
    }
}
</style>
{% endblock %}

{% block content %}
<div class="dashboard-container">
    <!-- Header -->
    <div class="dashboard-header">
        <h1 class="dashboard-title">Dashboard</h1>
        <p class="dashboard-subtitle">Welcome back! Here's what's happening with your system.</p>
    </div>

    <!-- Quick Actions -->
    <div class="quick-actions">
        <h3>Quick Actions</h3>
        <div class="actions-grid">
            {% for action in quick_actions %}
            <a href="{% url action.url %}" class="action-card">
                <div class="action-icon icon-{{ action.color }}">
                    <i class="bi {{ action.icon }}"></i>
                </div>
                <div class="action-text">
                    <h4>{{ action.title }}</h4>
                    <p>{{ action.description }}</p>
                </div>
            </a>
            {% endfor %}
        </div>
    </div>

    <!-- Statistics Grid -->
    <div class="stats-grid">
        <!-- <div class="stat-card">
            <div class="stat-value stat-primary">{{ total_people|default:0 }}</div>
            <div class="stat-label">Total People</div>
            <p class="stat-detail">{{ active_people|default:0 }} currently active</p>
        </div> -->

        <div class="stat-card">
            <div class="stat-value stat-success">{{ total_employees|default:0 }}</div>
            <div class="stat-label">Employees</div>
            <p class="stat-detail">{{ active_employees|default:0 }} active employees</p>
        </div>

        <!-- <div class="stat-card">
            <div class="stat-value stat-info">{{ total_workers|default:0 }}</div>
            <div class="stat-label">Workers</div>
            <p class="stat-detail">{{ active_workers|default:0 }} active workers</p>
        </div> -->

        <!-- <div class="stat-card">
            <div class="stat-value stat-warning">{{ total_vips|default:0 }}</div>
            <div class="stat-label">VIPs</div>
            <p class="stat-detail">{{ active_vips|default:0 }} active VIPs</p>
        </div> -->

        <!-- <div class="stat-card">
            <div class="stat-value stat-info">{{ total_buildings|default:0 }}</div>
            <div class="stat-label">Buildings</div>
            <p class="stat-detail">{{ total_floors|default:0 }} floors total</p>
        </div> -->

        <!-- <div class="stat-card">
            <div class="stat-value stat-success">${{ total_revenue|default:0|floatformat:0 }}</div>
            <div class="stat-label">Revenue</div>
            <p class="stat-detail">{{ total_invoices|default:0 }} invoices</p>
        </div> -->

        <!-- <div class="stat-card">
            <div class="stat-value stat-warning">{{ total_documents|default:0 }}</div>
            <div class="stat-label">Documents</div>
            <p class="stat-detail">{{ pending_documents|default:0 }} pending review</p>
        </div> -->

        <!-- <div class="stat-card">
            <div class="stat-value stat-info">{{ total_cards_printed|default:0 }}</div>
            <div class="stat-label">ID Cards</div>
            <p class="stat-detail">{{ recent_cards|default:0 }} printed this week</p>
        </div> -->

        <!-- <div class="stat-card">
            <div class="stat-value stat-danger">{{ active_probations|default:0 }}</div>
            <div class="stat-label">Probations</div>
            <p class="stat-detail">{{ probations_ending_soon|default:0 }} ending soon</p>
        </div> -->
    </div>

    <!-- Performance Indicators -->
    <div class="performance-section hidden">
        <h3 class="performance-title">System Performance</h3>
        <div class="performance-grid">
            <div class="performance-item">
                <div class="performance-circle {% if people_activity_rate >= 80 %}circle-excellent{% elif people_activity_rate >= 60 %}circle-good{% else %}circle-poor{% endif %}">
                    <span class="performance-percentage">{{ people_activity_rate|default:0 }}%</span>
                </div>
                <p class="performance-label">Activity Rate</p>
            </div>

            <div class="performance-item">
                <div class="performance-circle {% if document_processing_rate >= 80 %}circle-excellent{% elif document_processing_rate >= 60 %}circle-good{% else %}circle-poor{% endif %}">
                    <span class="performance-percentage">{{ document_processing_rate|default:0 }}%</span>
                </div>
                <p class="performance-label">Document Processing</p>
            </div>

            <div class="performance-item">
                <div class="performance-circle {% if invoice_collection_rate >= 80 %}circle-excellent{% elif invoice_collection_rate >= 60 %}circle-good{% else %}circle-poor{% endif %}">
                    <span class="performance-percentage">{{ invoice_collection_rate|default:0 }}%</span>
                </div>
                <p class="performance-label">Invoice Collection</p>
            </div>
        </div>
    </div>

    <!-- Recent Activity -->
    <div class="recent-activity">
        <h3 class="activity-title">Recent Activity</h3>
        <ul class="activity-list">
            {% if recent_employees %}
                {% for employee in recent_employees|slice:":3" %}
                <li class="activity-item">
                    <div class="activity-icon icon-primary">
                        <i class="bi bi-person-plus"></i>
                    </div>
                    <div class="activity-content">
                        <p class="activity-text">New employee: {{ employee.get_full_name }}</p>
                        <p class="activity-time">{{ employee.created_at|timesince }} ago</p>
                    </div>
                </li>
                {% endfor %}
            {% endif %}
            
            {% if recent_workers %}
                {% for worker in recent_workers|slice:":2" %}
                <!-- <li class="activity-item">
                    <div class="activity-icon icon-success">
                        <i class="bi bi-people"></i>
                    </div>
                    <div class="activity-content">
                        <p class="activity-text">New worker: {{ worker.get_full_name }}</p>
                        <p class="activity-time">{{ worker.created_at|timesince }} ago</p>
                    </div>
                </li> -->
                {% endfor %}
            {% endif %}
            
            {% if recent_vips %}
                {% for vip in recent_vips|slice:":2" %}
                <!-- <li class="activity-item">
                    <div class="activity-icon icon-warning">
                        <i class="bi bi-star-fill"></i>
                    </div>
                    <div class="activity-content">
                        <p class="activity-text">New VIP: {{ vip.get_full_name }}</p>
                        <p class="activity-time">{{ vip.created_at|timesince }} ago</p>
                    </div>
                </li> -->
                {% endfor %}
            {% endif %}
            
            {% if recent_documents %}
                {% for doc in recent_documents|slice:":2" %}
                <!-- <li class="activity-item">
                    <div class="activity-icon icon-info">
                        <i class="bi bi-file-text"></i>
                    </div>
                    <div class="activity-content">
                        <p class="activity-text">Document submitted: {{ doc.get_document_type_display }}</p>
                        <p class="activity-time">{{ doc.created_at|timesince }} ago</p>
                    </div>
                </li> -->
                {% endfor %}
            {% endif %}
            
            {% if not recent_employees and not recent_workers and not recent_documents %}
            <li class="activity-item">
                <div class="activity-icon icon-secondary">
                    <i class="bi bi-info-circle"></i>
                </div>
                <div class="activity-content">
                    <p class="activity-text">No recent activity</p>
                    <p class="activity-time">System is running smoothly</p>
                </div>
            </li>
            {% endif %}
        </ul>
    </div>

    <!-- Footer -->
    <div class="dashboard-footer">
        <p>Last updated: {{ "now"|date:"d/m/Y H:i" }}
            <span class="status-indicator">
                <span class="status-dot"></span>
                System Online
            </span>
        </p>
    </div>
</div>
{% endblock %}