{% comment %}
This template renders cards in pages based on the cards_per_page variable
{% endcomment %}

{% for page_cards in cards|slice_cards:cards_per_page %}
<div class="print-page">
    <div class="cards-grid {{ print_layout }}">
        {% for card in page_cards %}
        <div class="id-card {{ card_size }}">
            <div class="card-content">
                <div class="card-header">
                    {% if include_logo %}
                    <div class="company-logo">
                        <i class="fas fa-building"></i>
                    </div>
                    {% endif %}
                    <div class="card-number">
                        #{{ card.card_number|default:card.id }}
                    </div>
                </div>
                
                <div class="worker-section">
                    {% if card.worker.photo or card.photo %}
                        <img src="{% if card.photo %}{{ card.photo.url }}{% else %}{% url "zone:serve_worker_photo" card.worker.id %}{% endif %}" 
                             alt="{{ card.worker.get_full_name }}" class="worker-photo">
                    {% else %}
                        <div class="worker-photo-placeholder">
                            <i class="fas fa-user"></i>
                        </div>
                    {% endif %}
                    
                    <div class="worker-info">
                        <h3>{{ card.worker.get_full_name }}</h3>
                        <p><strong>ID:</strong> {{ card.worker.worker_id }}</p>
                        {% if card.worker.position %}
                            <p><strong>{{ card.worker.position.name }}</strong></p>
                        {% endif %}
                        {% if card.worker.zone and card.worker.building and card.worker.floor %}
                            <p>{{ card.worker.zone.name }}-{{ card.worker.building.code }}-F{{ card.worker.floor.floor_number }}</p>
                        {% elif card.worker.building %}
                            <p>{{ card.worker.building.name }}</p>
                        {% endif %}
                        <p>{{ card.get_status_display }}</p>
                    </div>
                </div>
                
                <div class="card-footer">
                    <div class="card-dates">
                        {% if card.issue_date %}
                            <div>{{ card.issue_date|date:"m/d/Y" }}</div>
                        {% endif %}
                        <div>Exp: {{ card.expiry_date|date:"m/d/Y" }}</div>
                    </div>
                    
                    <div style="display: flex; align-items: center;">
                        {% if include_qr_code %}
                        <div class="qr-code">
                            <i class="fas fa-qrcode"></i>
                        </div>
                        {% endif %}
                        
                        {% if include_barcode %}
                        <div class="barcode">
                            |||||||
                        </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}
        
        {% comment %}
        Fill remaining slots with empty cards if needed for consistent layout
        {% endcomment %}
        {% with remainder=page_cards|length %}
            {% if remainder < cards_per_page %}
                {% for i in cards_per_page|slice_range:remainder %}
                <div class="id-card-placeholder"></div>
                {% endfor %}
            {% endif %}
        {% endwith %}
    </div>
</div>
{% endfor %} 