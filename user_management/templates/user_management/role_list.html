{% extends 'base/base.html' %}
{% load static %}

{% block title %}Roles - User Management{% endblock %}

{% block main_class %}col-md-10 ms-sm-auto col-lg-10{% endblock %}

{% block extra_css %}
{{ block.super }}
<style>
/* Role List - Employee Table Style */
.container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 8px;
}

.header {
    background: white;
    padding: 8px 12px;
    border-radius: 4px;
    margin-bottom: 12px;
    border: 1px solid #e2e8f0;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.header h1 {
    color: #374151;
    font-size: 16px;
    font-weight: 600;
    margin: 0;
}

.btn {
    display: inline-block;
    padding: 3px 6px;
    margin: 1px;
    text-decoration: none;
    border-radius: 3px;
    font-size: 9px;
    border: none;
    cursor: pointer;
    font-weight: 500;
}

.btn-primary { background: #3b82f6; color: white; }
.btn-success { background: #16a34a; color: white; }
.btn-warning { background: #f59e0b; color: white; }
.btn-danger { background: #dc2626; color: white; }
.btn-secondary { background: #6b7280; color: white; }
.btn:hover { opacity: 0.9; }

.table-container {
    background: white;
    border: 1px solid #e2e8f0;
    border-radius: 6px;
    overflow: hidden;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
}

.table {
    margin: 0;
    font-size: 12px;
}

.table th {
    font-size: 11px;
    font-weight: 600;
    color: #374151;
    background: #f8fafb;
    border-bottom: 1px solid #e2e8f0;
    padding: 8px 12px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.table td {
    padding: 8px 12px;
    border-bottom: 1px solid #f1f5f9;
    vertical-align: middle;
}

.table tbody tr:last-child td {
    border-bottom: none;
}

.table tbody tr:hover {
    background: #f8fafb;
}

.role-name { 
    font-weight: 600; 
    color: #1a1a1a; 
    font-size: 13px;
    margin: 0;
}

.role-desc { 
    color: #6b7280; 
    font-size: 11px; 
    margin: 2px 0 0 0;
}

.perm-count,
.user-count {
    font-weight: 600;
    color: #1a1a1a;
    font-size: 12px;
}

/* Action buttons matching employee table */
.btn-modern {
    width: 20px;
    height: 20px;
    padding: 0;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    border-radius: 3px;
    border: 1px solid transparent;
    font-size: 9px;
    margin: 0 1px;
    text-decoration: none;
    transition: all 0.15s ease;
}

.btn-outline-modern {
    background: transparent;
    border-color: #d1d5db;
    color: #6b7280;
}

.btn-outline-modern:hover {
    background: #f3f4f6;
    color: #374151;
}

.btn-light-modern {
    background: #f8fafc;
    border-color: #e2e8f0;
    color: #64748b;
}

.btn-light-modern:hover {
    background: #f1f5f9;
    color: #475569;
}

.btn-danger-modern {
    background: #fef2f2;
    border-color: #fecaca;
    color: #dc2626;
}

.btn-danger-modern:hover {
    background: #fee2e2;
    color: #b91c1c;
}
</style>
{% endblock %}

{% block content %}
<div class="container">
    <div class="flex justify-between py-3">
        <h1 class="text-lg font-medium">Roles</h1>
        <div>
            {% if user.is_superuser %}
                <a href="{% url 'user_management:role_create' %}" class="button-min-primary">Add</a>
            {% endif %}
        </div>
    </div>

    <div class="table-container">
        <table class="table">
            <thead>
                <tr>
                    <th>Role</th>
                    <th>Permissions</th>
                    <th>Users</th>
                    <th>Created</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for role in roles %}
                <tr>
                    <td>
                        <div class="role-name">{{ role.name }}</div>
                        {% if role.description %}
                            <div class="role-desc">{{ role.description|truncatechars:50 }}</div>
                        {% endif %}
                    </td>
                    <td><span class="perm-count">{{ role.permissions.count }}</span></td>
                    <td><span class="user-count">{{ role.assignments.count }}</span></td>
                    <td>{{ role.created_at|date:"d/m/Y" }}</td>
                    <td>
                        <div class="d-flex gap-1">
                            <a href="{% url 'user_management:role_permissions' role.id %}" class="button-min-primary h-6 px-2 py-1" title="View Permissions">
                                <i class="bi bi-grid-3x3-gap"></i>
                            </a>
                            {% if user.is_superuser %}
                            <a href="{% url 'user_management:role_edit' role.id %}" class="button-min-default h-6 py-1 px-2" title="Edit Role">
                                <i class="bi bi-pencil"></i>
                            </a>
                            <button type="button" class="button-min-danger delete-btn h-6 px-2 py-1" title="Delete Role"
                            data-delete-url="{% url 'user_management:role_delete' role.id %}"
                            data-delete-title="Delete Role?"
                                                        data-delete-name="{{ role.name }}">
                                 <i class="bi bi-trash"></i>
                             </button>
                             {% endif %}
                        </div>
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="5" style="text-align: center; color: #666; padding: 24px; font-size: 11px;">No roles found</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %} 
{% block modals %}
    {% include 'components/delete_modal.html' %}
{% endblock %}
